---
title: "SDS313 - Homework 7 "
author: "Maria Berroa"
date: "2025-04-04"
output: html_document
---
##### Name: Maria Berroa

##### UTEID: mpb2544

##### GitHub: INSERT LINK HERE

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r, echo=FALSE, include=FALSE}
#Import libraries and files
library(ggplot2)
library(tidyverse)
library(mosaic)

armfold <- read.csv("armfold.csv")
vote <- read.csv("turnout.csv")

```


#### **Problem 1 - Armfolding**
##### **Part A**
##### There are 111 Females and 106 Male students in the dataset. The sample proportion of males who folded their left arm on top is 47.17%. The sample proportion of females who folded their left arm on top is 42.34%.

##### **Part B**
##### The observed difference in proportions between the two groups is about 4.83%. Meaning that on average 4.83% more males folded their left arm on top compared to females. 

##### **Part C**
##### When computing the confidence interval using R's built in function (prop.test), we obtain a proportion difference somewhere between -19.0% and +9.3%. 

##### **SE for difference in proportions and pluggen in values**
##### p1 = ((prop_male)*(1-prop_male)) / males
##### p2 = ((prop_female)*(1-prop_female)) / females
##### SE = sqrt(p1 + p2)
##### z-value
##### As usual, we calculated a confidence interval of 95%; therefore the z-value that we used for this calculation was 1.96. 

##### **Part D**
##### If we were to repeatedly sample from our population and wanted to compute the difference in the proportion of males and females who fold their left arm on top, then we would expect that, in 95% of the samples, the difference in proportions would fall between -19% and +9.3%.Since our confidence interval includes 0, it means there could be no difference in proportions of these two groups; therefore we can say that this difference in proportions is not statistically significant.

##### **Part E**
##### The standard error calculated above represents the variability in our statistical summary. In this case, the difference in sample proportions (males vs. females who fold with their left arm on top). It measures how much variation of our statistical summary we would expect to see across many repeated samples.

##### **Part F**
##### In this context, the term sampling distribution refers to the distribution of the difference in sample proportions between our two groups that we would observe under repeated sampling fromt he same random process that generated all data. This distribution would be centered at the true population mean of difference in proportions.

##### What varies from sample to sample is the summary statistic, in this case, the difference in sample proportions. Thus slightly changing the values of our confidence interval. This variation comes from random sampling variability. On the other hand, there are some things that stays fixed, which are the true proportions of the population (center of the distribution), and the overall shape of the distribution, which is what we call a normal distribution (bell curve).

##### **Part G**
##### The mathematical result that justifies using a normal distribution to approximate the sampling distibution of the difference in sample proportions is the Central Limit Theorem. This theorem states that once we take a large number of samples from a population- regardless of the population shape- and compute the difference in sample proportions (or other summary statistic) for each one, the distribution of those differences will become normal. This means it will be centered around the true difference in population proportions. 

##### **Part H**
##### Based on a 95% confidence interval of [-0.01, 0.30], to someone who says that "there's no sex difference in arm folding," I would say that they are probably right - but not entirely. Our confidence interval is simply stating that if we were to compute a difference in proportions we would expect our value to fall anywhere between -1% and 30%. This means that there is a probability that the difference is, in fact, 0; however this doesn't rule out other possibilities, such as a difference as large as 30%. Something we could say is that even though there exists a probability of no difference, the result is not statistically significant, and we would need more data to confidently determine wheather a sex difference in arm folding exists. 

##### **Part I**
##### If we were to repeat this experiment many times with different random samples of university students, the confidence intervals would indeed vary from sample to sample. They wouldn't be drasticaly different, but they would differ to some extent due to natural variation in the samples. However, what should be true about the collections of all those intervals is that, in the long run, about 95% of them would contain the true value of the difference in proportions. 

```{r, echo=FALSE, results='hide'}
#how many males/ females
males = sum(armfold$Sex == "Male")
females = sum(armfold$Sex == "Female")

#sample proportion of left arm on top male/ female
prop_male = sum(armfold$Sex == "Male" & armfold$LonR_fold ==1) / males
prop_female = sum(armfold$Sex == "Female" & armfold$LonR_fold == 1) / females

prop(LonR_fold ~ Sex, data= armfold, success = 1)

#difference in proportions
diffprop(LonR_fold ~ Sex, data = armfold, success = 1)

#bootstrapping -> confidence interval
boot_armfold_prop = do(1000)*diffprop(LonR_fold ~ Sex, data = mosaic::resample(armfold))
confint(boot_armfold_prop)

#using prop.test -> confidence interval
prop.test(LonR_fold ~ Sex, data=armfold,success = 1)

#show work
#SE for difference in proportions
#formula for SE and values plugged into formula
p1 = ((prop_male)*(1-prop_male)) / males
p2 = ((prop_female)*(1-prop_female)) / females
SE = sqrt(p1 + p2)
#confidence interval / values match with R's built in function
0.04827469 + 2*SE
0.04827469 - 2*SE
#z-value
#As usual, we calculated a confidence interval of 95%; therefore the z-value that we used for this calculation was 1.96. 

```

#### **Problem 2 - Get out the vote**
##### **Part A**
##### The sample proportion of those receiving a a GOTV call who voted in 1998 is 64.8%. The sample proportion fo those not receiving a GOTV call who also voted in 1998 is 44.4%. 

##### If we were to repeatedly sample from our population and compute the difference in the proportion of those who voted and received a call vs. those who didn't, we would expect that,in 95% of the samples, the difference in proportions would fall between 14.1% and 26.6%. Since our confidence interval does not include 0, it means that it is not plausible that the difference in proportions between these two groups is 0. Therefore, we assume that the difference in proportions is statistically significant.

##### **Part B**
##### Voted 1996 is a confounder:
##### People who did not get called and voted in 1996 are, 61% voted in 1998
##### People who did not get a call and did not vote in 1996, 76% did not vote in 1998

##### People who got a call and voted in 1996, 23% voted in 1998
##### People who got a call and did not vote in 1996, 0.4% voted in 1998

##### This shows a correlation between those who did not receive a call, voted in 1996 and about 61% of them voted again in 1998. On the other hand, those who got a call, and voted in 1996, about 23% voted again in 1998. This shows that, regardless of the call, those who voted in 1996 were likely to vote again in 1998.

#### Given those who voted in 1996, we are 95% confident that the difference in 1998 voting rates between those who received a call and those who did not ranges between 7.8% and 20%

##### AGE is a confounder:
##### Those who did not get a call: the ones whose ages were younger were much less likely to vote in 1998. On the other hand, we see that the ones whose ages were older did, in fact, vote in 1998.

##### Those who got a call: the ones whose ages were younger were slightly less likely to vote in 1998. On the other hand, we see that those who were older had a higher voting percentage in 1998.

##### This shows that, regardless of the call, those whose ages ranged more on the older side had higher voting percentages in 1998 than those whose ages were younger. Thus, this shows age is a confounder.

##### MAJORPTY is a confounder:
##### Those who did not receive a call and were not registered, the majority of them did not vote in 1998. Among those who were registered, around 50% voted in 1998. Those who received a call and were not registered, more than 50% of them voted in 1998. Among those who were registered, around 70% voted in 1998. This shows that, regardless of the call, those who were registered had higher voting percentages in 1998 than those who were not registered. Therefore, MAJORPTY is a confounder.

#### Given those who are registered as a memeber of a political party, we are 95% confident that the difference in 1998 voting rates between those who received a call and those who did not ranges between 12% and 26%


##### **Part C**

```{r, echo=FALSE, results='hide'}
#prop of those receiving a GOTV call who voted
govt_call_voted = sum(vote$voted1998 == 1 & vote$GOTV_call==1) / sum(vote$GOTV_call == 1)
#prop of those not receiving a GOTV call who voted
no_govt_call_voted = sum(vote$voted1998 == 1 &vote$GOTV_call==0) / sum(vote$GOTV_call == 0)
#using prop
prop(voted1998 ~ GOTV_call, data= vote, success = 1)

#large sample confidence interval
#bootstrapping -> confidence interval
boot_vote_prop = do(1000)*diffprop(voted1998 ~ GOTV_call, data = mosaic::resample(vote))
confint(boot_vote_prop)

#using prop.test -> confidence interval
prop.test(voted1998 ~ GOTV_call, data=vote,success = 1)

#evidence voted1996 is confounder
xtabs(~voted1998 + voted1996 + GOTV_call, data=vote) %>%
  prop.table(margin=2)
#association with treatment(call)
#People who did not get called and voted in 1996 are, 61% voted in 1998
#People who did not get a call and did not vote in 1996, 76% did not vote in 1998

#People who got a call and voted in 1996, 23% voted in 1998
#People who got a call and did not vote in 1996, 0.4% voted in 1998

#This shows a correlation between those who did not receive a call, voted in 1996 and about 61% of them voted again in 1998. On the other hand, those who got a call, and voted in 1996, about 23% voted again in 1998. This shows that, regardless of the call, those who voted in 1996 were likely to vote again in 1998. 

boot_v1996 <- do(1000) * diffprop(voted1998 ~ GOTV_call, 
                                  data = mosaic::resample(subset(vote, voted1996 == 1)))
confint(boot_v1996)

```

```{r, echo=FALSE}
#evidence AGE is confounder
ggplot(vote, aes(x = as.factor(GOTV_call), y = AGE, fill = as.factor(voted1998))) +
  geom_boxplot()
```
```{r, echo=FALSE}
#evidence MAJORPTY is a confounder
ggplot(vote, aes(x = as.factor(MAJORPTY), fill = as.factor(voted1998))) +
  geom_bar(position = "fill") +
  facet_wrap(~GOTV_call)
boot_party <- do(1000) * diffprop(voted1998 ~ GOTV_call, 
                                  data = mosaic::resample(subset(vote, MAJORPTY == 1)))
confint(boot_party)
```

